var a = "global";
{
  fun showA() {
    print a;  // Should print "global"
  }

  showA();   // Works correctly
  var a = "block";
  showA();   // BUG: Now prints "block" instead of "global"!
}

var a = "before";
fun makeFunction() {
  fun inner() {
    print a;  // Should capture "before"
  }
  return inner;
}

var fn = makeFunction();
var a = "after";
fn();  // BUG: Prints "after" instead of "before"